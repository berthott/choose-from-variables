name: 'Choose from variables'
description: 'Choose from variables'
branding:
  icon: 'list'
  color: 'purple'

on:
  workflow_call:
    inputs:
      variable:
        description: 'The variable to choose from'
        required: true
      selection:
        description: 'The selection to make from the variable'
        required: true
      secret:
        description: 'Whether the variable is a secret'
        required: false
      multiline:
        description: 'Whether the variable is multiline'
        required: false

jobs:
  steps:  
    - if: ${{ inputs.secret == 'false' && inputs.multiline == 'false' }}
      name: 'Choose single line from variable'
      run: |
        ${{ inputs.variable }}=$(echo '${{ format('vars.{0}, inputs.variable }}' | grep "^${{ inputs.selection }}=" | cut -d '=' -f2 | tr -d '\r\n')
        echo $${{ inputs.variable }}
        echo "${{ inputs.variable }}=$${{ inputs.variable }}" >> $GITHUB_ENV